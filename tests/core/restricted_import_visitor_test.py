"""
Restricted import visitor tests.

To run this test file only:
poetry run python -m pytest -vvvrca tests/core/restricted_import_visitor_test.py
"""
from collections import defaultdict

import pytest

from flake8_custom_import_rules.core.restricted_import_visitor import RestrictedImportVisitor
from flake8_custom_import_rules.core.restricted_import_visitor import get_restricted_identifiers
from flake8_custom_import_rules.defaults import convert_to_dict
from flake8_custom_import_rules.utils.node_utils import get_package_names

RESTRICTED_IMPORTS = [
    "my_second_base_package",
    "my_second_base_package.module_one",
    "my_second_base_package.module_one.file_one",
    "my_third_base_package",
    "my_second_base_package.module_one",
    "my_second_base_package.module_two",
    "my_base_module",
]


@pytest.mark.parametrize(
    ("restricted_imports", "check_module_exists", "expected"),
    [(RESTRICTED_IMPORTS, True, {}), (RESTRICTED_IMPORTS, False, {}), ([], True, {})],
)
def test_get_restricted_identifiers(
    restricted_imports: list[str] | str,
    check_module_exists: bool,
    expected: dict,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=restricted_imports, check_module_exists=check_module_exists
    )
    assert isinstance(restricted_identifiers, defaultdict)


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package.module_one.file_one",
            {"my_base_module", "my_second_base_package.module_two", "my_third_base_package"},
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_third_base_package",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_base_module",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_second_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
            },
        ),
    ],
)
def test_restricted_import_visitor(
    file_package: str,
    expected: defaultdict[str, list[str]],
) -> None:
    """Test get_restricted_identifiers."""
    restricted_import_visitor = RestrictedImportVisitor(
        restricted_packages=RESTRICTED_IMPORTS,
        check_module_exists=True,
        import_restrictions=defaultdict(list),
        file_packages=get_package_names(file_package),
    )
    restricted_import_visitor.get_restricted_identifiers()
    assert isinstance(restricted_import_visitor, RestrictedImportVisitor)
    assert set(restricted_import_visitor.restricted_identifiers.keys()) == expected
    for key in restricted_import_visitor.restricted_identifiers.keys():
        assert isinstance(restricted_import_visitor.restricted_identifiers[key], defaultdict)
        assert restricted_import_visitor.restricted_identifiers[key]


IMPORT_RESTRICTIONS = [
    "my_second_base_package:my_third_base_package,my_base_module",
    (
        "my_second_base_package.module_one:my_second_base_package,my_third_base_package,"
        "my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_one.file_one:my_second_base_package,"
        "my_second_base_package.module_one,my_third_base_package,my_second_base_package."
        "module_one,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_third_base_package:my_second_base_package,my_second_base_package."
        "module_one,my_second_base_package.module_one.file_one,my_second_base_package."
        "module_one,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_one:my_second_base_package,"
        "my_third_base_package,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_two:my_second_base_package,"
        "my_second_base_package.module_one,my_second_base_package.module_one."
        "file_one,my_third_base_package,my_second_base_package.module_one,my_base_module"
    ),
    (
        "my_base_module:my_second_base_package,my_second_base_package.module_one,"
        "my_second_base_package.module_one.file_one,my_third_base_package,"
        "my_second_base_package.module_one,my_second_base_package.module_two"
    ),
]


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package.module_one.file_one",
            {"my_base_module", "my_third_base_package", "my_second_base_package.module_two"},
        ),
        (
            "my_second_base_package.module_one.file_two",
            {"my_base_module", "my_second_base_package.module_two", "my_third_base_package"},
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_third_base_package",
                "my_base_module",
            },
        ),
        (
            "my_second_base_package.module_one",
            {"my_base_module", "my_second_base_package.module_two", "my_third_base_package"},
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_second_base_package",
            {"my_base_module", "my_third_base_package"},
        ),
    ],
)
def test_get_restricted_identifiers__import_restrictions(
    file_package: str,
    expected: dict,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=[],
        check_module_exists=False,
        import_restrictions=convert_to_dict(IMPORT_RESTRICTIONS),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package",
            {
                "my_third_base_package.module_one.file_one",
                "my_base_module.module_two",
                "my_base_module.module_one",
                "my_base_module.module_two.file_one",
                "my_third_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package",
                "my_third_base_package.module_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one.file_one",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_third_base_package.file",
                "my_third_base_package",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.file",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_second_base_package.module_two.file_two",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_base_module",
                "my_second_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_base_module.module_one.file_one",
            },
        ),
        (
            "my_second_base_package.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_second_base_package.module_one",
                "my_base_module.file",
                "my_base_module.module_two.file_one",
                "my_third_base_package",
                "my_second_base_package.file",
                "my_base_module.module_one.file_two",
                "my_base_module.module_one",
                "my_base_module.module_two",
                "my_base_module",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
            },
        ),
        (
            "my_second_base_package.file",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_second_base_package.module_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package",
            },
        ),
        (
            "my_base_module.module_one",
            {
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_one",
                "my_base_module.module_two",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_third_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.file",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package",
                "my_third_base_package.module_one",
                "my_base_module.file",
                "my_third_base_package",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_two.file_one",
            },
        ),
        (
            "my_base_module.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two",
            {
                "my_third_base_package.file",
                "my_third_base_package.module_two",
                "my_third_base_package",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_two",
                "my_base_module.file",
                "my_second_base_package.module_one",
                "my_second_base_package.file",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package",
            },
        ),
        (
            "my_base_module.module_two.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.file",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_second_base_package.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_one",
            },
        ),
        (
            "my_third_base_package.module_one",
            {
                "my_third_base_package.file",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.file",
                "my_second_base_package.module_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one",
                "my_base_module.module_two.file_one",
                "my_third_base_package.module_two",
                "my_second_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module.module_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_one",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_two",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_two",
            {
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_third_base_package.file",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package",
                "my_third_base_package.module_one.file_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_base_module.module_one.file_one",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_two",
                "my_base_module",
                "my_third_base_package.module_one.file_one",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_two",
            },
        ),
        (
            "my_third_base_package.module_two.file_one",
            {
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one",
                "my_base_module",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_second_base_package.file",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
            },
        ),
        (
            "my_third_base_package.module_two.file_two",
            {
                "my_base_module.module_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_base_module.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_base_module",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two.file_one",
                "my_third_base_package.module_one",
                "my_second_base_package.file",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_third_base_package.file",
            {
                "my_second_base_package",
                "my_second_base_package.module_one",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.file",
                "my_second_base_package.module_two",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_base_module",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_two.file_one",
            },
        ),
    ],
)
def test_get_restricted_identifiers__import_restrictions_two(
    file_package: str,
    expected: dict,
    package_8: list,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=[],
        check_module_exists=False,
        import_restrictions=convert_to_dict(package_8),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one.file_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.file",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module",
            {
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one",
            {
                "my_base_module.file",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one.file_one",
            {
                "my_base_module.file",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one.file_two",
            {
                "my_base_module.file",
                "my_base_module.module_one.file_one",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two",
            {
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two.file_one",
            {
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two.file_two",
            {
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two.file_one",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.file",
            {
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package.module_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package.module_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
            },
        ),
        (
            "my_third_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
            },
        ),
        (
            "my_third_base_package.module_two.file_two",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_one",
            },
        ),
        (
            "my_third_base_package.file",
            {
                "my_base_module",
                "my_base_module.file",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_fifth_base_package",
                "my_fourth_base_package",
                "my_second_base_package",
                "my_second_base_package.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_third_base_package.module_two.file_two",
            },
        ),
    ],
)
def test_get_restricted_identifiers__restricted_identifiers(
    file_package: str,
    expected: dict,
    package_8: list,
    package_9: list,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=package_9,
        check_module_exists=False,
        import_restrictions=convert_to_dict(package_8),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]
