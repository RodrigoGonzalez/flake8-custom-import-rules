"""
Restricted import visitor tests.

To run this test file only:
poetry run python -m pytest -vvvrca tests/core/restricted_import_visitor_test.py
"""
import itertools
from collections import defaultdict

import pytest

from flake8_custom_import_rules.core.restricted_import_visitor import RestrictedImportVisitor
from flake8_custom_import_rules.core.restricted_import_visitor import get_restricted_identifiers
from flake8_custom_import_rules.defaults import convert_to_dict
from flake8_custom_import_rules.utils.node_utils import get_package_names

PACKAGE_6 = [
    "my_second_base_package",
    "my_second_base_package.module_one",
    "my_second_base_package.module_one.file_one",
    "my_third_base_package",
    "my_second_base_package.module_one",
    "my_second_base_package.module_two",
    "my_base_module",
]


@pytest.mark.parametrize(
    ("restricted_imports", "check_module_exists", "expected"),
    [(PACKAGE_6, True, {}), (PACKAGE_6, False, {}), ([], True, {})],
)
def test_get_restricted_identifiers(
    restricted_imports: list[str] | str,
    check_module_exists: bool,
    expected: dict,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=restricted_imports, check_module_exists=check_module_exists
    )
    assert isinstance(restricted_identifiers, defaultdict)


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package.module_one.file_one",
            {"my_base_module", "my_second_base_package.module_two", "my_third_base_package"},
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_third_base_package",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_base_module",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_second_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
            },
        ),
    ],
)
def test_restricted_import_visitor(
    file_package: str,
    expected: defaultdict[str, list[str]],
) -> None:
    """Test get_restricted_identifiers."""
    restricted_import_visitor = RestrictedImportVisitor(
        restricted_packages=PACKAGE_6,
        check_module_exists=True,
        import_restrictions=defaultdict(list),
        file_packages=get_package_names(file_package),
    )
    restricted_import_visitor.get_restricted_identifiers()
    assert isinstance(restricted_import_visitor, RestrictedImportVisitor)
    assert set(restricted_import_visitor.restricted_identifiers.keys()) == expected
    for key in restricted_import_visitor.restricted_identifiers.keys():
        assert isinstance(restricted_import_visitor.restricted_identifiers[key], defaultdict)
        assert restricted_import_visitor.restricted_identifiers[key]


PACKAGE_7 = [
    "my_second_base_package:my_third_base_package,my_base_module",
    (
        "my_second_base_package.module_one:my_second_base_package,my_third_base_package,"
        "my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_one.file_one:my_second_base_package,"
        "my_second_base_package.module_one,my_third_base_package,my_second_base_package"
        "module_one,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_third_base_package:my_second_base_package,my_second_base_package"
        "module_one,my_second_base_package.module_one.file_one,my_second_base_package"
        "module_one,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_one:my_second_base_package,"
        "my_third_base_package,my_second_base_package.module_two,my_base_module"
    ),
    (
        "my_second_base_package.module_two:my_second_base_package,"
        "my_second_base_package.module_one,my_second_base_package.module_one"
        "file_one,my_third_base_package,my_second_base_package.module_one,my_base_module"
    ),
    (
        "my_base_module:my_second_base_package,my_second_base_package.module_one,"
        "my_second_base_package.module_one.file_one,my_third_base_package,"
        "my_second_base_package.module_one,my_second_base_package.module_two"
    ),
]


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package.module_one.file_one",
            {"my_base_module", "my_second_base_package.module_two", "my_third_base_package"},
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_third_base_package",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two",
                "my_base_module",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_base_module",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_second_base_package",
            {
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package",
            },
        ),
    ],
)
def test_get_restricted_identifiers__import_restrictions(
    file_package: str,
    expected: dict,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=[],
        check_module_exists=False,
        import_restrictions=convert_to_dict(PACKAGE_7),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]


@pytest.fixture(scope="module")
def package_7() -> list:
    """Test get_restricted_identifiers."""
    package_7 = []
    first_list = [
        "my_second_base_package",
        "my_base_module",
        "my_third_base_package",
    ]
    second_list = ["", "module_one", "module_two", "file"]
    third_list = ["", "file_one", "file_two"]
    for first, second in itertools.product(first_list, second_list):
        if second in [""]:
            package_7.append(first)
            continue
        if f"{second}" in ["file"]:
            package_7.append(f"{first}.{second}")
            continue
        for third in third_list:
            if f"{second}.{third}" in [".", "file.file_one", "file.file_two"]:
                package_7.append(f"{first}.{second}")
                continue
            package_7.append(f"{first}.{second}.{third}".strip("."))
    return package_7


@pytest.fixture(scope="module")
def package_8(package_7) -> list:
    """Test get_restricted_identifiers."""
    package_8 = []
    for restricted_package in package_7:
        temp = [package for package in PACKAGE_6 if not restricted_package.startswith(package)]
        package_8.append(f"{restricted_package}:{','.join(temp)}")
    return package_8


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
            },
        ),
        (
            "my_second_base_package.file",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
            },
        ),
        (
            "my_base_module.file",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_one",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_one",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_one.file_two",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
            },
        ),
        (
            "my_third_base_package.module_two",
            {
                "my_second_base_package",
                "my_base_module",
                "my_third_base_package.file",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_base_module.module_one",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_second_base_package.module_two.file_one",
            },
        ),
        (
            "my_third_base_package.module_two.file_one",
            {
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one",
                "my_base_module",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_second_base_package.file",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
            },
        ),
        (
            "my_third_base_package.module_two.file_two",
            {
                "my_base_module.module_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_base_module.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_base_module",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two.file_one",
                "my_third_base_package.module_one",
                "my_second_base_package.file",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_one",
            },
        ),
        (
            "my_third_base_package.file",
            {
                "my_second_base_package",
                "my_second_base_package.module_one",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.file",
                "my_second_base_package.module_two",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_base_module",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_two.file_one",
            },
        ),
    ],
)
def test_get_restricted_identifiers__import_restrictions_two(
    file_package: str,
    expected: dict,
    package_8: list,
) -> None:
    """Test get_restricted_identifiers."""
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=[],
        check_module_exists=False,
        import_restrictions=convert_to_dict(package_8),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]


@pytest.mark.parametrize(
    ("file_package", "expected"),
    [
        (
            "my_second_base_package",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_two.file_one",
            {
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_second_base_package.file",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_base_module",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_one.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_third_base_package.file",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_one.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_two.file_one",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.module_two.file_two",
            {
                "my_second_base_package.module_two.file_one",
                "my_third_base_package",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_second_base_package",
                "my_third_base_package.module_two.file_one",
                "my_base_module.module_one",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_base_module.file",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_third_base_package",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_one",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_one.file_one",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_one.file_two",
            {
                "my_third_base_package.file",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_base_module",
                "my_base_module.module_one",
                "my_second_base_package",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.file",
                "my_third_base_package.module_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_two",
            {
                "my_second_base_package",
                "my_base_module",
                "my_third_base_package.file",
                "my_second_base_package.module_one.file_one",
                "my_second_base_package.module_one",
                "my_third_base_package.module_one.file_one",
                "my_base_module.module_one",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_third_base_package.module_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package.file",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_two.file_one",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.module_two.file_two",
                "my_second_base_package.module_two.file_one",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_two.file_one",
            {
                "my_second_base_package.module_one.file_two",
                "my_second_base_package.module_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_one",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_one",
                "my_base_module",
                "my_third_base_package.module_two.file_two",
                "my_third_base_package.module_one",
                "my_base_module.module_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_two.file_two",
                "my_third_base_package.file",
                "my_second_base_package.file",
                "my_second_base_package.module_two.file_one",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.file",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_one.file_one",
                "my_third_base_package.module_one.file_two",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.module_two.file_two",
            {
                "my_base_module.module_one",
                "my_third_base_package.file",
                "my_second_base_package.module_two.file_two",
                "my_base_module.file",
                "my_second_base_package.module_one",
                "my_second_base_package.module_one.file_two",
                "my_third_base_package.module_one.file_two",
                "my_base_module.module_two.file_two",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two",
                "my_third_base_package.module_two.file_one",
                "my_base_module",
                "my_second_base_package",
                "my_base_module.module_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.module_two.file_one",
                "my_third_base_package.module_one",
                "my_second_base_package.file",
                "my_base_module.module_one.file_one",
                "my_third_base_package.module_one.file_one",
                "my_second_base_package.module_one.file_one",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
        (
            "my_third_base_package.file",
            {
                "my_second_base_package",
                "my_second_base_package.module_one",
                "my_third_base_package.module_two.file_two",
                "my_base_module.module_two.file_one",
                "my_second_base_package.file",
                "my_second_base_package.module_two",
                "my_base_module.module_one",
                "my_base_module.module_one.file_one",
                "my_base_module.file",
                "my_third_base_package.module_one",
                "my_third_base_package.module_two",
                "my_third_base_package.module_one.file_two",
                "my_second_base_package.module_two.file_two",
                "my_second_base_package.module_one.file_one",
                "my_base_module.module_one.file_two",
                "my_second_base_package.module_two.file_one",
                "my_base_module.module_two.file_two",
                "my_base_module",
                "my_second_base_package.module_one.file_two",
                "my_base_module.module_two",
                "my_third_base_package.module_one.file_one",
                "my_third_base_package.module_two.file_one",
                "my_fourth_base_package",
                "my_fifth_base_package",
            },
        ),
    ],
)
def test_get_restricted_identifiers__restricted_identifiers(
    file_package: str,
    expected: dict,
    package_8: list,
) -> None:
    """Test get_restricted_identifiers."""
    package_9 = [
        "my_second_base_package",
        "my_second_base_package.module_one",
        "my_second_base_package.module_one.file_one",
        "my_third_base_package",
        "my_second_base_package.module_one",
        "my_second_base_package.module_two",
        "my_base_module",
        "my_fourth_base_package",
        "my_fifth_base_package",
    ]
    restricted_identifiers = get_restricted_identifiers(
        restricted_packages=package_9,
        check_module_exists=False,
        import_restrictions=convert_to_dict(package_8),
        file_packages=get_package_names(file_package),
    )
    assert isinstance(restricted_identifiers, defaultdict)
    assert set(restricted_identifiers.keys()) == expected
    for key in restricted_identifiers.keys():
        assert restricted_identifiers[key], defaultdict
        assert restricted_identifiers[key]
